<!DOCTYPE html>
<html>

<head>
	<meta name="author" content="Drag and Drop" />
	<meta name="description" content="Drag and drop table content with JavaScript" />
	<meta name="viewport" content="width=device-width, user-scalable=no" /><!-- "position: fixed" fix for Android 2.2+ -->
	<!-- <link rel="stylesheet" href="style.css" type="text/css" media="screen" /> -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
	<!-- <script type="text/javascript" src="header.js"></script> -->
	<script type="text/javascript" src="redips-drag-min.js"></script>
	<!-- <script type="text/javascript" src="script.js"></script> -->
	<!-- load jQuery -->
	<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
	<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.9.2/jquery-ui.min.js"></script>
	<link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.9.2/themes/base/jquery-ui.css" />
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
	<title>Drag and Drop</title>

	<style>
		body {
			font-family: arial;
			margin: 0px;
			/* for IE6 / IE7 */
			min-width: 90vw !important;
			width: 90vw !important;
		}

		.redips-mark {
			font-size: 1.5rem;
			font-weight: bold;
		}

		/* drag objects (DIV inside table cells) */
		.redips-drag {
			cursor: move;
			margin: auto 5px;
			background-color: rgb(18, 160, 18);
			color: white;
			text-align: center;
			font-size: 1rem;
			/* needed for cloned object */
			font-weight: bold;
			width: auto;
			min-width: 100px;
			height: 35px;
			line-height: 29px;
			/* round corners */
			border-radius: 4px;
			/* Opera, Chrome */
			-moz-border-radius: 4px;
			/* FF */
		}

		/* make drag container visible */
		#redips-drag {
			/* border: 2px dashed LightBlue; */
			display: table;
			margin: auto;
			padding: 3px;
		}

		/* tables */
		div#redips-drag table {
			background-color: #F2F5F7;
			border-collapse: collapse;
			margin: 20px;
		}

		/* table cells */
		div#redips-drag td {
			border: 1px #AED0EA solid;
			height: 50px;
			text-align: center;
			font-size: 10pt;
			padding: 2px;
			min-width: 100px;
		}

		/* green objects */
		.green {
			border: 2px solid darkgreen;
		}

		/* trash cell */
		.redips-trash {
			color: white;
			font-weight: bold;
			background-color: rgb(238, 38, 38);
		}
	</style>


</head>

<body>
	<!-- drag container -->
	<div id="redips-drag">
		<!-- table2 -->
		<div style="display: flex;">
			<form action="" method="post">
				<div>
					<table id="table2">
						<colgroup>
							<col width="120" />
							<col width="120" />
							<col width="120" />
							<col width="120" />
							<col width="120" />
						</colgroup>
						<tbody>
							<tr>
								<td class="redips-mark">A</td>
								<td class="redips-mark">B</td>
								<td class="redips-mark">C</td>
								<td class="redips-mark">D</td>
								<td class="redips-mark">E</td>
							</tr>
							<tr>
								<td>
									<div id="A1" name="name1" class="redips-drag green">A1<input type="hidden" value="A1"></div>
								</td>
								<td></td>
								<td></td>
								<td></td>
								<td></td>
							</tr>
							<tr>
								<td>
									<div id="A2" name="name2" class="redips-drag green">A2<input type="hidden" value="A2"></div>
								</td>
								<td></td>
								<td></td>
								<td></td>
								<td></td>
							</tr>
							<tr>
								<td>
									<div id="A3" name="name3" class="redips-drag green">A3<input type="hidden" value="A3"></div>
								</td>
								<td></td>
								<td></td>
								<td></td>
								<td></td>
							</tr>
							<tr>
								<td>
									<div id="A4" name="name4" class="redips-drag green">A4<input type="hidden" value="A4"></div>
								</td>
								<td></td>
								<td></td>
								<td></td>
								<td></td>
							</tr>
							<tr>
								<td>
									<div id="A5" name="name5" class="redips-drag green">A5<input type="hidden" value="A5"></div>
								</td>
								<td></td>
								<td></td>
								<td></td>
								<td></td>
							</tr>
						</tbody>
					</table>

					<div style="display: flex; justify-content: flex-end; margin-right: 20px;">
						<!-- <button type="button" class="btn btn-sm bg-success text-white addNew" style="width: 100px">
						New
					</button> -->
						<button type="submit" class="btn btn-sm bg-primary text-white"
							style="margin-left: 10px; width: 100px; background-color: #1065bf !important; padding: 8px 10px !important;">
							参加する
						</button>

					</div>

				</div>
			</form>

			<!-- table1 -->
			<table id="table1" class="hidden" style="background-color: #fff;">
				<colgroup>
					<col width="120" />
					<col width="120" />
					<col width="120" />
				</colgroup>
				<tbody>
					<!-- clone 2 elements + last element -->
					<tr>
						<td>
							<div id="a" class="redips-drag green redips-clone" name="" style="min-width: 105px; max-width: 105px; white-space: normal; word-break: break-all; height: auto; min-height: 35px;">A</div>
						</td>
						<td class="redips-mark">
							<input id="btnName" type="text" style="height: 32px; outline: none; font-size: 1rem; width: 195px; margin: auto 5px;" onkeyup="$('#a').text(this.value)" maxlength="30"></td>
						<td class="redips-trash">削除 <i class="fa fa-trash-o" style="margin-left: 5px; font-size: 1rem;"></i></td>
					</tr>
				</tbody>
			</table>
		</div>

	<script>
		/* eslint-env browser, jquery */
			/* eslint
				 semi: ["error", "always"],
				 indent: [2, "tab"],
				 no-tabs: 0,
				 no-multiple-empty-lines: ["error", {"max": 2, "maxEOF": 1}],
				 one-var: ["error", "always"] */
			/* global REDIPS */

			/* enable strict mode */
			'use strict';


			// global variables
			let redips = {},		// redips container
				rd = REDIPS.drag,	// reference to the REDIPS.drag library
				counter = 5,		// counter for cloned DIV elements
				clonedDIV = false,	// cloned flag set in event.moved
				lastCell;			// reference to the last cell in table


			// redips initialization
			redips.init = function () {
				// set reference to the last cell in table
				// lastCell = document.getElementById('lastCell');
				// initialization
				rd.init();
				// shift DIV elements with animation
				rd.shift.animation = true;
				// dragged elements can be placed only to the empty cells
				rd.dropMode = 'single';
				// disabled elements will have opacity effect
				rd.style.opacityDisabled = 50;
				// set hover color
				rd.hover.colorTd = '#9BB3DA';
				// rd.hover.borderTd = '2px solid red';

				// add counter to cloned element name
				// (after cloned DIV element is dropped to the table)
				rd.event.cloned = function () {
					counter++;
					let buttonNameValue = document.getElementById("btnName").value;
					rd.obj.setAttribute("name", "name" + counter);
					if (buttonNameValue == "") {
						// increase counter
						// append to the DIV element name
						rd.obj.innerHTML += counter;
						// rd.obj.siblings('aHidden').value = 'something';
					}
				};

				// rd.event.changed = function () {
				// 	// get target and source position (method returns positions as array)
				// 	let pos = rd.getPosition();
				// 	// display current row and current cell
				// 	// msg.innerHTML = 'Changed: ' + pos[1] + ' ' + pos[2];
				// 	console.log(pos[1] + ' ' + pos[2]);
				// };

				rd.event.dropped = function () {
					// get target and source position (method returns positions as array)
					// pos[0] - target table index
					// pos[1] - target row index
					// pos[2] - target cell (column) index
					// pos[3] - source table index
					// pos[4] - source row index
					// pos[5] - source cell (column) index
					// var pos = rd.getPosition();

					// if ( pos[1] == 1 && pos[2] == 0 || pos[1] == 2 && pos[2] == 0 || pos[1] == 3 && pos[2] == 0 || pos[1] == 4 && pos[2] == 0 || pos[1] == 5 && pos[2] == 0 ) {
					// 	rd.obj.innerHTML = 'A' + ' ' + pos[1];	
					// }

					// else if (pos[1] == 1 && pos[2] == 1 || pos[1] == 2 && pos[2] == 1 || pos[1] == 3 && pos[2] == 1 || pos[1] == 4 && pos[2] == 1 || pos[1] == 5 && pos[2] == 1) {
					// 	rd.obj.innerHTML = 'B' + ' ' + pos[1];
					// }

					// else if (pos[1] == 1 && pos[2] == 2 || pos[1] == 2 && pos[2] == 2 || pos[1] == 3 && pos[2] == 2 || pos[1] == 4 && pos[2] == 2 || pos[1] == 5 && pos[2] == 2) {
					// 	rd.obj.innerHTML = 'C' + ' ' + pos[1];
					// }

					// else if (pos[1] == 1 && pos[2] == 3 || pos[1] == 2 && pos[2] == 3 || pos[1] == 3 && pos[2] == 3 || pos[1] == 4 && pos[2] == 3 || pos[1] == 5 && pos[2] == 3) {
					// 	rd.obj.innerHTML = 'D' + ' ' + pos[1];
					// }

					// else if (pos[1] == 1 && pos[2] == 4 || pos[1] == 2 && pos[2] == 4 || pos[1] == 3 && pos[2] == 4 || pos[1] == 4 && pos[2] == 4 || pos[1] == 5 && pos[2] == 4) {
					// 	rd.obj.innerHTML = 'E' + ' ' + pos[1];
					// }

					// rd.obj.innerHTML = pos[1] + ' ' + pos[2];
					let divVal = rd.obj.innerHTML;
					rd.obj.innerHTML += "<input type='hidden' name='"+ divVal +"' value='"+ divVal +"'>";
					
				};

			};

			// confirm DIV element delete action
			REDIPS.drag.trash.question = 'Are you sure you want to delete DIV element?';

			// add onload event listener
			if (window.addEventListener) {
				window.addEventListener('load', redips.init, false);
			}
			else if (window.attachEvent) {
				window.attachEvent('onload', redips.init);
			}

	</script>

</body>

</html>